OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:{},initialize:function(e,t,a,r){var s=[];a=OpenLayers.Util.upperCaseObject(a),parseFloat(a.VERSION)>=1.3&&!a.EXCEPTIONS&&(a.EXCEPTIONS="INIMAGE"),s.push(e,t,a,r),OpenLayers.Layer.Grid.prototype.initialize.apply(this,s),OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS)),!this.noMagic&&this.params.TRANSPARENT&&"true"==this.params.TRANSPARENT.toString().toLowerCase()&&(null!=r&&r.isBaseLayer||(this.isBaseLayer=!1),"image/jpeg"==this.params.FORMAT&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png"))},clone:function(e){return null==e&&(e=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions())),e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e])},reverseAxisOrder:function(){var e=this.projection.getCode();return parseFloat(this.params.VERSION)>=1.3&&!!(this.yx[e]||OpenLayers.Projection.defaults[e]&&OpenLayers.Projection.defaults[e].yx)},getURL:function(e){e=this.adjustBounds(e);var t=this.getImageSize(),a={},r=this.reverseAxisOrder();a.BBOX=this.encodeBBOX?e.toBBOX(null,r):e.toArray(r),a.WIDTH=t.w,a.HEIGHT=t.h;var s=this.getFullRequestString(a);return s},mergeNewParams:function(e){var t=OpenLayers.Util.upperCaseObject(e),a=[t];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,a)},getFullRequestString:function(e){var t=this.map.getProjectionObject(),a=this.projection&&this.projection.equals(t)?this.projection.getCode():t.getCode(),r="none"==a?null:a;return parseFloat(this.params.VERSION)>=1.3?this.params.CRS=r:this.params.SRS=r,"boolean"==typeof this.params.TRANSPARENT&&(e.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE"),OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"});